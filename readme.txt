
Этот пакет содержит две утилиты для обработки сетевых сегментов - nlcheck и nlmake.
Обе они написаны на perl, теоретически должны работыть под любой OS, на практике тестировались 
только под Linux.

=====

nlcheck может применяться как у RC для проверки принимаемых сетевых сегментов, 
так и у NC для проверки своего сегмента перед отправкой.
Для запуска нужно скопировать nlcheck и nlcheck.conf в каталог, где у вас находится всё, 
относящееся к fido, пробежаться по nlcheck.conf, подправив необходимые параметры (файл 
содержит описание параметров внутри) и прописать правильный путь к nlcheck.conf внутри 
скрипта nlcheck (строка "require" в начале). После этого можно запустить nlcheck, дав 
ему параметром имя файла с сегментом, и посмотреть, что он расскажет. Имя сетевого сегмента 
должно быть net_NNNN.DDD или net_NNN.DDD, где NNN или NNNN - номер сети, DDD - номер дня в году 
или 999 (вообще-то это число игнорируется).

RC может установить в конфиге "$checkonly = 0", тогда после проверки корректные сегменты будут 
складываться в каталог $okdir, некорректные - в $faildir. Кроме того, отчёт о проверке сегмента 
будет отправлен NC и RC. Если в конфиге указаны переменные $cvs и $cvsdir, корректные сегменты 
кроме того будут помещаться в каталог $cvsdir (с расширением ".ok" вместо номера дня в году) 
и коммититься в CVS, чтобы была сохранена история изменений сегмента. Вариант "$checkonly = 0" 
предполагается использовать для автоматической обработки присылаемых сегментов.

Если установлен "$checkonly = 0", то для того, чтобы проверить сетевой сегмент, никуда его не
перемещая и не отправляя никакие репорты, можно вторым параметром укзать слово "check". Например, 
"nlcheck net_463.999 check" просто проверит сегмент и выведет результат на stdout.

nlcheck может выдавать как ошибки (если сегмент некорректен), так и предупреждения (сегмент 
формально корректен, но есть некоторые неточности).
Основные ошибки:
- нарушение формата строки, невозможность понять, где там что, пробелы внутри строки;
- неправильный формат телефонного номера, неизвестный keyword, недопустимый speed, неизвестный флаг;
- включение экскоммуницированного узла;
- совпадение телефонных номеров у разных узлов сети;
- неправильный код страны или неправильная длина телефонного номера;
- явное указание подразумеваемого флага (например, "V90C,V34");
- неправильный NC (определяется по имени сисопа - номер узла может меняться);
- неправильная контрольная сумма (если указана).

Основные предупреждения:
- неправильный код города для телефонного номера;
- флаг времени работы не покрывает ZMH;
- флаг LO у хоста;
- неожиданный флаг UREC или URPK у одного из узлов сети; отсутствие ожидаемого флага UREC или URPK;
- хост, указанный IP-флагом, не существует;
- узел более двух недель в холде или дауне (если установлен параметр "$checkhold = 1");
и множество других.

Предупреждения можно отключать специальными строками внутри сегмента, начинающимися с ";W".
Эти строки будут удалены из сетевого сегмента перед включением его в региональный сегмент.
Например, строка ";W -order" означает не давать предупреждение о нарушении порядка номеров хабов 
или узлов подхабника, эту строку можно поставить перед узлом или хабом, чей номер меньше предыдущего.
";W -modem"   - не предупреждать о странностях в модемных флагах;
";W -zmh"     - не предупреждать о том, что время работы не покрывает ZMH;
";W -resolve" - не предупреждать об отсутствии хоста, указанного в IP-флаге;
";W -email"   - не предупреждать о некорректности email-адреса, указанного в IMI или IEM-флаге;
";W -npk", ";W -nec" - в сети действительно нет NPK или, соответственно, NECа.

=====

nlmake формирует региональный сегмент из имеющихся сетевых сегментов и (опционально) отправляет его ZC.
Для запуска нужно, как и nlcheck, скопировать nlmake и nlmake.conf в каталог, где вам будет удобно его 
использовать, настроить параметры в файле nlmake.conf и изменить путь к файлу nlmake.conf внутри скрипта 
nlmake (строка "require").
nlmake пишет заголовок сегмента (в т.ч. считает CRC), создаёт файл $destdir/$rsegname.$yday (тут 
$destdir и $rsegname - указанные в конфиге параметры, каталог и имя сегмента, а $yday - номер дня в году, 
к которому относится этот сегмент).
Если вторым параметром дать слово "send", сформированный сегмент будет приаттачен ZC.


Pavel Gulchouck, 2:463/68, gul@gul.kiev.ua

